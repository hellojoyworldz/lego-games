<!DOCTYPE html>
<html>
  <head>
    <title>777 ìŠ¬ë¡¯ë¨¸ì‹ </title>
    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        background-color: #1f2937;
        color: white;
      }
      .container {
        text-align: center;
        padding: 2rem;
        background-color: #374151;
        border-radius: 1rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .slot-machine {
        display: flex;
        gap: 1rem;
        margin: 2rem 0;
        justify-content: center;
      }
      .reel {
        width: 100px;
        height: 100px;
        background-color: #4b5563;
        border: 4px solid #fbbf24;
        border-radius: 0.5rem;
        overflow: hidden;
        position: relative;
        display: flex;
        justify-content: center;
      }
      .reel.spinning {
        border-color: #ef4444;
      }
      .symbols-strip {
        position: absolute;
        left: 0;
        right: 0;
        display: flex;
        flex-direction: column;
        will-change: transform;
      }
      .symbol {
        width: 100px;
        height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .symbol span {
        font-size: 3rem;
        line-height: 1;
        height: 3rem;
        display: block;
      }
      button {
        padding: 0.75rem 1.5rem;
        font-size: 1.25rem;
        font-weight: bold;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
        margin: 0 0.5rem;
        transition: all 0.2s;
      }
      button:disabled {
        background-color: #6b7280;
        cursor: not-allowed;
      }
      .spin-button {
        background-color: #fbbf24;
      }
      .spin-button:hover:not(:disabled) {
        background-color: #f59e0b;
      }
      .stop-button {
        background-color: #ef4444;
      }
      .stop-button:hover:not(:disabled) {
        background-color: #dc2626;
      }
      .slow-button {
        background-color: #10b981;
      }
      .slow-button:hover:not(:disabled) {
        background-color: #059669;
      }
      .input-field {
        width: 150px;
        padding: 0.5rem;
        border-radius: 0.5rem;
        border: none;
        margin-right: 1rem;
        background-color: #4b5563;
        color: white;
        font-size: 1.25rem;
      }
      .status-text {
        margin: 1rem 0;
        font-size: 1.25rem;
      }
      .info {
        margin-top: 1.5rem;
        color: #9ca3af;
        font-size: 0.875rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>777 ìŠ¬ë¡¯ë¨¸ì‹ </h1>

      <div class="slot-machine">
        <div class="reel" id="reel1"><div class="symbols-strip"></div></div>
        <div class="reel" id="reel2"><div class="symbols-strip"></div></div>
        <div class="reel" id="reel3"><div class="symbols-strip"></div></div>
      </div>

      <div class="status-text" id="credits">í¬ë ˆë”§: 1000</div>
      <div class="status-text" id="speedStatus">í˜„ì¬ ì†ë„: ë³´í†µ</div>

      <div style="margin-bottom: 0.5rem; color: #10b981" id="costPreview">
        ì˜ˆìƒ ë¹„ìš©: 100 í¬ë ˆë”§
      </div>

      <div style="margin-bottom: 1rem">
        <label for="betInput">ë² íŒ… ê¸ˆì•¡:</label>
        <input
          type="number"
          id="betInput"
          min="100"
          value="100"
          class="input-field"
        />
      </div>

      <div style="margin: 1rem 0">
        <button class="spin-button" id="spinButton">ìŠ¤í•€!</button>
        <button class="stop-button" id="stopButton" disabled>ì •ì§€</button>
        <button class="slow-button" id="slowButton">
          ì†ë„ ê°ì†Œ (50 í¬ë ˆë”§)
        </button>
      </div>

      <div class="status-text" id="message">ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”!</div>

      <div class="info">
        ë°°ë‹¹ê¸ˆ:<br />
        777: ë² íŒ…ì•¡ x 50<br />
        3ê°œ ê°™ì€ ì‹¬ë³¼: ë² íŒ…ì•¡ x 10<br />
        2ê°œ ê°™ì€ ì‹¬ë³¼: ë² íŒ…ì•¡ x 2
      </div>
    </div>

    <script>
      const symbols = ["7", "ğŸ’", "ğŸŠ", "ğŸ‹", "ğŸ’", "â­"];
      let credits = 1000;
      let currentSpeed = 30;
      let currentBet = 100;
      let speedDecreaseCost = 0;
      let animationFrames = [null, null, null];
      let nextStopIndex = 0;
      let isSpinning = false;
      let positions = [0, 0, 0];

      // ì†ë„ ìƒìˆ˜
      const SPEED_NORMAL = 30;
      const SPEED_SLOW = 15;
      const SPEED_VERY_SLOW = 7.5;

      const reels = [
        document.getElementById("reel1"),
        document.getElementById("reel2"),
        document.getElementById("reel3"),
      ];

      const strips = reels.map((reel) => reel.querySelector(".symbols-strip"));
      const spinButton = document.getElementById("spinButton");
      const stopButton = document.getElementById("stopButton");
      const slowButton = document.getElementById("slowButton");
      const creditsDisplay = document.getElementById("credits");
      const messageDisplay = document.getElementById("message");
      const speedDisplay = document.getElementById("speedStatus");
      const costPreview = document.getElementById("costPreview");
      const betInput = document.getElementById("betInput");

      function initializeStrips() {
        strips.forEach((strip) => {
          strip.innerHTML = "";
          for (let i = 0; i < symbols.length * 8; i++) {
            const symbolDiv = document.createElement("div");
            symbolDiv.className = "symbol";
            const span = document.createElement("span");
            span.textContent = symbols[i % symbols.length];
            symbolDiv.appendChild(span);
            strip.appendChild(symbolDiv);
          }
          strip.style.transform = "translateY(0)";
        });
      }

      function updateCredits() {
        creditsDisplay.textContent = `í¬ë ˆë”§: ${credits}`;
      }

      function updateSpeedDisplay() {
        let speedText = "ë³´í†µ";
        if (currentSpeed <= SPEED_VERY_SLOW) {
          speedText = "ë§¤ìš° ëŠë¦¼";
        } else if (currentSpeed <= SPEED_SLOW) {
          speedText = "ëŠë¦¼";
        }
        speedDisplay.textContent = `í˜„ì¬ ì†ë„: ${speedText}`;
      }

      function updateCostPreview() {
        const betAmount = parseInt(betInput.value) || 0;
        const totalCost = betAmount + speedDecreaseCost;

        if (speedDecreaseCost > 0) {
          costPreview.textContent = `ì˜ˆìƒ ë¹„ìš©: ë² íŒ… ${betAmount} + ì†ë„ê°ì†Œ ${speedDecreaseCost} = ì´ ${totalCost} í¬ë ˆë”§`;
        } else {
          costPreview.textContent = `ì˜ˆìƒ ë¹„ìš©: ${betAmount} í¬ë ˆë”§`;
        }
      }

      function animate(index) {
        positions[index] += currentSpeed;

        const totalHeight = symbols.length * 100;

        if (positions[index] >= totalHeight) {
          positions[index] = 0;
        }

        strips[index].style.transform = `translateY(${-positions[index]}px)`;
        animationFrames[index] = requestAnimationFrame(() => animate(index));
      }

      function decreaseSpeed() {
        if (currentSpeed <= SPEED_VERY_SLOW) {
          messageDisplay.textContent = "ì´ë¯¸ ìµœì € ì†ë„ì…ë‹ˆë‹¤!";
          return;
        }

        currentSpeed = currentSpeed / 2;
        speedDecreaseCost += 50;
        updateSpeedDisplay();
        updateCostPreview();
        messageDisplay.textContent = "ë‹¤ìŒ ìŠ¤í•€ì—ì„œ ì†ë„ê°€ ê°ì†Œë©ë‹ˆë‹¤!";

        if (currentSpeed <= SPEED_VERY_SLOW) {
          slowButton.disabled = true;
        }
      }

      function startSpin() {
        const betAmount = parseInt(betInput.value);
        const totalCost = betAmount + speedDecreaseCost;

        if (isNaN(betAmount) || betAmount < 100) {
          messageDisplay.textContent = "ìµœì†Œ ë² íŒ… ê¸ˆì•¡ì€ 100 í¬ë ˆë”§ì…ë‹ˆë‹¤!";
          return;
        }

        if (credits < totalCost) {
          messageDisplay.textContent = "í¬ë ˆë”§ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!";
          return;
        }

        credits -= totalCost;
        updateCredits();
        messageDisplay.textContent = "ì •ì§€ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë¦´ì„ ë©ˆì¶°ì£¼ì„¸ìš”!";
        isSpinning = true;
        nextStopIndex = 0;
        currentBet = betAmount;

        speedDecreaseCost = 0;
        updateCostPreview();

        spinButton.disabled = true;
        stopButton.disabled = false;
        slowButton.disabled = true;
        betInput.disabled = true;

        positions = [0, 0, 0];
        reels.forEach((reel, index) => {
          if (index === 0) {
            reel.classList.add("spinning");
          }
          animationFrames[index] = requestAnimationFrame(() => animate(index));
        });
      }

      function stopNextReel() {
        if (nextStopIndex >= 3) return;

        const currentReel = nextStopIndex;
        cancelAnimationFrame(animationFrames[currentReel]);
        reels[currentReel].classList.remove("spinning");

        const symbolHeight = 100;
        const currentPos = positions[currentReel];
        const nearestSymbol =
          Math.round(currentPos / symbolHeight) * symbolHeight;

        strips[currentReel].style.transition = "transform 0.2s ease-out";
        strips[currentReel].style.transform = `translateY(${-nearestSymbol}px)`;
        positions[currentReel] = nearestSymbol;

        setTimeout(() => {
          strips[currentReel].style.transition = "";
        }, 200);

        nextStopIndex++;

        if (nextStopIndex < 3) {
          reels[nextStopIndex].classList.add("spinning");
        }

        if (nextStopIndex >= 3) {
          isSpinning = false;
          stopButton.disabled = true;
          spinButton.disabled = false;
          slowButton.disabled = false;
          betInput.disabled = false;
          currentSpeed = SPEED_NORMAL;
          updateSpeedDisplay();
          setTimeout(checkWin, 200);
        }
      }

      function getVisibleSymbols() {
        return positions.map((pos) => {
          const symbolIndex = Math.round(pos / 100) % symbols.length;
          return symbols[symbolIndex];
        });
      }

      function checkWin() {
        const results = getVisibleSymbols();
        const multiplier = currentBet / 100;

        if (results[0] === "7" && results[1] === "7" && results[2] === "7") {
          const winAmount = Math.floor(5000 * multiplier);
          credits += winAmount;
          messageDisplay.textContent = `ì­íŒŸ! ${winAmount} í¬ë ˆë”§ íšë“!`;
        } else if (results[0] === results[1] && results[1] === results[2]) {
          const winAmount = Math.floor(1000 * multiplier);
          credits += winAmount;
          messageDisplay.textContent = `3ê°œ ì¼ì¹˜! ${winAmount} í¬ë ˆë”§ íšë“!`;
        } else if (
          results[0] === results[1] ||
          results[1] === results[2] ||
          results[0] === results[2]
        ) {
          const winAmount = Math.floor(200 * multiplier);
          credits += winAmount;
          messageDisplay.textContent = `2ê°œ ì¼ì¹˜! ${winAmount} í¬ë ˆë”§ íšë“!`;
        } else {
          messageDisplay.textContent = "ì•„ì‰½ë„¤ìš”! ë‹¤ì‹œ ë„ì „í•˜ì„¸ìš”.";
        }

        updateCredits();
      }

      betInput.addEventListener("input", updateCostPreview);
      spinButton.addEventListener("click", startSpin);
      stopButton.addEventListener("click", stopNextReel);
      slowButton.addEventListener("click", decreaseSpeed);

      // ì´ˆê¸°í™”
      initializeStrips();
      updateSpeedDisplay();
      updateCostPreview();
    </script>
  </body>
</html>
